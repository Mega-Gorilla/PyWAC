# PyWAC バージョン管理戦略

## 📋 概要

このドキュメントは、PyWACのバージョン管理とドキュメント戦略を概説します。

## 🏗️ リポジトリ構造

```
pypac/
├── CHANGELOG.md           # ユーザー向けの変更履歴（Keep a Changelogフォーマット）
├── RELEASE_NOTES.md       # 現在のバージョンの詳細リリースノート
├── VERSION               # 現在のバージョン番号
├── docs/
│   ├── README_ja.md      # ドキュメントインデックス
│   └── migrations/       # バージョン移行ガイド
└── pywac/
    └── __init__.py       # __version__変数を含む
```

## 📊 バージョニング戦略

[セマンティックバージョニング](https://semver.org/lang/ja/)に従います：

**MAJOR.MINOR.PATCH**
- **MAJOR**: 互換性のないAPI変更
- **MINOR**: 後方互換性のある機能追加
- **PATCH**: 後方互換性のあるバグ修正

### 例
- `0.1.0` → `0.2.0`: 新機能（プロセス固有録音）
- `0.2.0` → `0.3.0`: 新機能（AudioDataクラス）
- `0.3.0` → `0.4.0`: 破壊的変更（キューベースアーキテクチャ）

## 📝 ドキュメント戦略

### 1. CHANGELOG.md
- **フォーマット**: [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/)
- **内容**: すべてのユーザー向け変更
- **セクション**:
  - Added（追加）
  - Changed（変更）
  - Deprecated（非推奨）
  - Removed（削除）
  - Fixed（修正）
  - Security（セキュリティ）

### 2. RELEASE_NOTES.md
- **目的**: 各リリースの詳細説明
- **内容**:
  - 主要な変更のサマリー
  - 破壊的変更の詳細
  - 移行手順
  - 既知の問題

### 3. VERSION ファイル
- **目的**: バージョン番号の唯一の情報源
- **フォーマット**: `X.Y.Z`（改行なし）
- **使用**: CIパイプラインとビルドスクリプト

### 4. 移行ガイド
- **場所**: `docs/migrations/vX.Y.Z-feature-name.md`
- **内容**:
  - 破壊的変更の詳細
  - ステップバイステップの移行手順
  - コード例（前後）

## 🔄 リリースプロセス

### 1. 準備
```bash
# 1. VERSIONファイルを更新
echo "0.4.0" > VERSION

# 2. __init__.pyのバージョンを更新
# __version__ = "0.4.0"

# 3. CHANGELOG.mdを更新
# 未リリースセクションを新バージョンセクションに移動

# 4. RELEASE_NOTES.mdを更新
# 新バージョンの詳細を追加
```

### 2. コミットとタグ付け
```bash
git add -A
git commit -m "Release v0.4.0: キューベースアーキテクチャ"
git tag -a v0.4.0 -m "Release v0.4.0"
```

### 3. プッシュとリリース
```bash
git push origin main --tags
# GitHubリリースを作成
```

## 📦 パッケージング

### PyPIの考慮事項
将来PyPIにパブリッシュする場合：
1. `setup.py`がVERSIONファイルを読み取る
2. `__version__`が`pywac/__init__.py`から読み取られる
3. 一貫性のチェックがCIパイプラインで実行される

## 🏷️ タグ付け規約

- **フォーマット**: `vMAJOR.MINOR.PATCH`
- **例**: `v0.4.0`、`v1.0.0`
- **プレリリース**: `v0.4.0-rc.1`、`v0.4.0-beta.2`

## 📊 バージョン履歴

| バージョン | リリース日 | 主要な変更 |
|---------|-----------|----------|
| v0.4.0 | 2024-12-26 | キューベースアーキテクチャ、< 5% CPU |
| v0.3.0 | 2024-12-25 | AudioDataクラス、統一フォーマット |
| v0.2.0 | 2024-12-XX | Process Loopback API |
| v0.1.0 | 2024-12-XX | 初期リリース |

## ✅ リリースチェックリスト

- [ ] すべてのテストが合格
- [ ] VERSIONファイルが更新された
- [ ] `__version__`が更新された
- [ ] CHANGELOG.mdが更新された
- [ ] RELEASE_NOTES.mdが更新された
- [ ] 移行ガイドが作成された（破壊的変更の場合）
- [ ] ドキュメントが更新された
- [ ] 例がテストされた
- [ ] gitタグが作成された
- [ ] GitHubリリースが作成された

## 🔮 将来の改善

1. **自動化**
   - バージョンバンプスクリプト
   - CHANGELOGの自動生成
   - リリースノートのテンプレート

2. **検証**
   - バージョンの一貫性チェック
   - 破壊的変更の検出
   - APIの互換性テスト

3. **配布**
   - PyPIパブリッシング
   - ホイールの作成
   - プラットフォーム固有のパッケージ